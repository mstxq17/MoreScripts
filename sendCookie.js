/*
Author：xq17
=============================================
用于上传当前面板的Cookie到指定的青龙面板
url: 青龙面板地址  例如: htt://127.0.0.1:5700
ClientID: 应用ID  例如: kd-h92C09f7C
ClientSecret: 应用密钥 例如 tsQi5XqB3xZ3Hjj_cu7LI_ba
=============================================
*/

'usr strict';

const got = require('got');

let qlUrl = "htt://127.0.0.1:5700"
let clientID = "kd-h92C09f7C"
let clientSecret = "tsQi5XqB3xZ3Hjj_cu7LI_ba"

function _0x7f21(_0x3c96f0,_0x4c9ce2){const _0x48203d=_0x4820();return _0x7f21=function(_0x7f213e,_0x1c06a7){_0x7f213e=_0x7f213e-0x84;let _0x504742=_0x48203d[_0x7f213e];return _0x504742;},_0x7f21(_0x3c96f0,_0x4c9ce2);}const _0x408d5=_0x7f21;(function(_0x3744f7,_0x161a6b){const _0x546da7=_0x7f21,_0x2c669c=_0x3744f7();while(!![]){try{const _0x198d74=-parseInt(_0x546da7(0x8f))/0x1*(-parseInt(_0x546da7(0x9f))/0x2)+-parseInt(_0x546da7(0x97))/0x3+parseInt(_0x546da7(0xa3))/0x4+-parseInt(_0x546da7(0xa8))/0x5*(-parseInt(_0x546da7(0xa0))/0x6)+-parseInt(_0x546da7(0x9e))/0x7*(-parseInt(_0x546da7(0x94))/0x8)+-parseInt(_0x546da7(0xb6))/0x9*(parseInt(_0x546da7(0x99))/0xa)+-parseInt(_0x546da7(0xac))/0xb;if(_0x198d74===_0x161a6b)break;else _0x2c669c['push'](_0x2c669c['shift']());}catch(_0x1cda0c){_0x2c669c['push'](_0x2c669c['shift']());}}}(_0x4820,0xca775));let CookieJDs=[];if(process[_0x408d5(0xb2)][_0x408d5(0xa6)]){if(process[_0x408d5(0xb2)][_0x408d5(0xa6)][_0x408d5(0xaa)]('&')>-0x1)CookieJDs=process['env'][_0x408d5(0xa6)][_0x408d5(0xad)]('&');else process[_0x408d5(0xb2)][_0x408d5(0xa6)][_0x408d5(0xaa)]('\x0a')>-0x1?CookieJDs=process['env']['JD_COOKIE'][_0x408d5(0xad)]('\x0a'):CookieJDs=[process['env'][_0x408d5(0xa6)]];}CookieJDs=[...new Set(CookieJDs[_0x408d5(0xae)](_0x390eee=>!!_0x390eee))],console[_0x408d5(0x86)](_0x408d5(0x8b)+CookieJDs[_0x408d5(0xaf)]+_0x408d5(0xba)),console['log'](_0x408d5(0xa7)+qlUrl),console[_0x408d5(0x86)](_0x408d5(0x87)+clientID['substr'](0x5)[_0x408d5(0x9a)](clientID[_0x408d5(0xaf)],'*')),console[_0x408d5(0x86)]('ClientSecret:\x20'+clientSecret[_0x408d5(0x84)](0xa)['padEnd'](clientSecret[_0x408d5(0xaf)],'*'));const api=got[_0x408d5(0xab)]({'prefixUrl':qlUrl,'retry':{'limit':0x0}});function _0x4820(){const _0x58f345=['log','ClientID:\x20','json',')\x20Cookie：\x20','code','\x0a===============当前面板','getDate','\x20已更新成功','Finish\x20Task\x20Done!','206209kJEuVn','value','get','getMinutes',')Cookie：\x20','4197112YaJYTa','put','data','54153BJLPie','getMonth','1613830cQLOso','padEnd','application/json;charset=UTF-8','application/json','match','14HvTCOS','8PLadSO','18066OdbnSZ','@autoCookie','===============Date:','1445672oZWMbI','open/envs','getHours','JD_COOKIE','目标:','2445DMVThx','pt_key=1A2A1Ji5nqEADBTypOfxMSS5v6DotOHtWmanbqWQkbPs6y61H4x44pqJwx2t2XuW7OpEH0guxIhNlI;pt_pin=mstxq171123;','indexOf','extend','26140510tKaOEl','split','filter','length','getSeconds','open/envs/enable','env','catch','Bearer\x20','remarks','27gNvYyO','token','\x20已成功添加','finally','个京东账号Cookie===============\x0a','substr','now'];_0x4820=function(){return _0x58f345;};return _0x4820();}getToken=async()=>{const _0x1790cb=_0x408d5,_0x42608c=await api({'method':_0x1790cb(0x91),'url':'open/auth/token?client_id='+clientID+'&client_secret='+clientSecret})[_0x1790cb(0x88)]();return _0x42608c['data'][_0x1790cb(0xb7)];},getEnvs=async()=>{const _0x553923=_0x408d5,_0x3dba9b=await getToken(),_0x29d8b7=await api({'url':_0x553923(0xa4),'searchParams':{'searchValue':_0x553923(0xa6),'t':Date[_0x553923(0x85)]()},'headers':{'Accept':_0x553923(0x9c),'authorization':_0x553923(0xb4)+_0x3dba9b}})[_0x553923(0x88)]();return _0x29d8b7[_0x553923(0x96)];},addEnv=async(_0x47d03f,_0x10b83a)=>{const _0x95928e=_0x408d5,_0x2cf185=await getToken(),_0x130ef1=await api({'method':'post','url':_0x95928e(0xa4),'params':{'t':Date[_0x95928e(0x85)]()},'json':[{'name':_0x95928e(0xa6),'value':_0x47d03f,'remarks':_0x10b83a}],'headers':{'Accept':_0x95928e(0x9c),'authorization':'Bearer\x20'+_0x2cf185,'Content-Type':_0x95928e(0x9b)}})[_0x95928e(0x88)]();return _0x130ef1;},EnableCk=async _0x1c6580=>{const _0x21a8c6=_0x408d5,_0x556242=await getToken(),_0x3c4a73=await api({'method':_0x21a8c6(0x95),'url':_0x21a8c6(0xb1),'params':{'t':Date[_0x21a8c6(0x85)]()},'body':JSON['stringify']([_0x1c6580]),'headers':{'Accept':_0x21a8c6(0x9c),'authorization':_0x21a8c6(0xb4)+_0x556242,'Content-Type':'application/json;charset=UTF-8'}})[_0x21a8c6(0x88)]();return _0x3c4a73;},getEnvByPtPin=async _0x1aaa1d=>{const _0x36c7b1=_0x408d5,_0x288756=await getEnvs();for(let _0x2f1d9e=0x0;_0x2f1d9e<_0x288756['length'];_0x2f1d9e++){var _0xa1977b=decodeURIComponent(_0x288756[_0x2f1d9e]['value'][_0x36c7b1(0x9d)](/pt_pin=([^; ]+)(?=;?)/)&&_0x288756[_0x2f1d9e][_0x36c7b1(0x90)][_0x36c7b1(0x9d)](/pt_pin=([^; ]+)(?=;?)/)[0x1]);if(_0xa1977b==_0x1aaa1d)return _0x288756[_0x2f1d9e];}return'';},updateEnv=async(_0x3f6d7c,_0x2b785a,_0x1fba74)=>{const _0x4f8447=_0x408d5,_0x11db78=await getToken(),_0x5aed4f=await api({'method':_0x4f8447(0x95),'url':'open/envs','params':{'t':Date[_0x4f8447(0x85)]()},'json':{'name':_0x4f8447(0xa6),'value':_0x3f6d7c,'_id':_0x2b785a,'remarks':_0x1fba74},'headers':{'Accept':_0x4f8447(0x9c),'authorization':_0x4f8447(0xb4)+_0x11db78,'Content-Type':_0x4f8447(0x9b)}})[_0x4f8447(0x88)]();return _0x5aed4f;},!(async()=>{const _0x5ecbd5=_0x408d5;CookieJDs=['pt_key=1A2A1Ji5nqEADBTypOfxMSS5v6DotOHtWmanbqWQkbPs6y61H4x44pqJwx2t2XuW7OpEH0guxIhNlI;pt_pin=mstxq17123;',_0x5ecbd5(0xa9)];for(let _0x3e5307=0x0;_0x3e5307<CookieJDs[_0x5ecbd5(0xaf)];_0x3e5307++){Ptpin=decodeURIComponent(CookieJDs[_0x3e5307][_0x5ecbd5(0x9d)](/pt_pin=([^; ]+)(?=;?)/)&&CookieJDs[_0x3e5307][_0x5ecbd5(0x9d)](/pt_pin=([^; ]+)(?=;?)/)[0x1]),isNext=await getEnvByPtPin(Ptpin),isNext!=''?(result=await updateEnv(CookieJDs[_0x3e5307],isNext['_id'],isNext[_0x5ecbd5(0xb5)]),result&&result[_0x5ecbd5(0x8a)]==0xc8&&console[_0x5ecbd5(0x86)](_0x3e5307+0x1+_0x5ecbd5(0x93)+Ptpin+_0x5ecbd5(0x8d))):(result=await await addEnv(CookieJDs[_0x3e5307],Date[_0x5ecbd5(0x85)]()+_0x5ecbd5(0xa1)),result&&result['code']==0xc8&&console['log'](_0x3e5307+0x1+_0x5ecbd5(0x89)+Ptpin+_0x5ecbd5(0xb8)));}})()[_0x408d5(0xb3)](_0x3d2892=>console[_0x408d5(0x86)](_0x3d2892))[_0x408d5(0xb9)](()=>{const _0x3f63a6=_0x408d5;console[_0x3f63a6(0x86)](_0x3f63a6(0xa2)+getTime()+'==============='),console[_0x3f63a6(0x86)](_0x3f63a6(0x8e));});function getTime(){const _0x54f34d=_0x408d5;let _0x32dbfe=new Date(),_0x41420e=_0x32dbfe['getFullYear'](),_0x3e36c1=_0x32dbfe[_0x54f34d(0x98)]()+0x1<0xa?'0'+(_0x32dbfe['getMonth']()+0x1):_0x32dbfe['getMonth']()+0x1,_0x26daca=_0x32dbfe[_0x54f34d(0x8c)]()<0xa?'0'+_0x32dbfe[_0x54f34d(0x8c)]():_0x32dbfe[_0x54f34d(0x8c)](),_0x5efd6c=_0x32dbfe[_0x54f34d(0xa5)]()<0xa?'0'+_0x32dbfe[_0x54f34d(0xa5)]():_0x32dbfe[_0x54f34d(0xa5)](),_0x30e303=_0x32dbfe[_0x54f34d(0x92)]()<0xa?'0'+_0x32dbfe[_0x54f34d(0x92)]():_0x32dbfe[_0x54f34d(0x92)](),_0x3b83a6=_0x32dbfe['getSeconds']()<0xa?'0'+_0x32dbfe[_0x54f34d(0xb0)]():_0x32dbfe[_0x54f34d(0xb0)]();return _0x41420e+'-'+_0x3e36c1+'-'+_0x26daca+'\x20'+_0x5efd6c+':'+_0x30e303+':'+_0x3b83a6;}